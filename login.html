<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Educa Materiais - Login & Cadastro</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Quicksand', sans-serif;
        }

        .tab-active {
            color: #fb923c;
            border-bottom: 3px solid #fb923c;
        }

        .input-pedagogico:focus {
            border-color: #fb923c;
            outline: none;
            background-color: #fffaf0;
        }

        .fade-in {
            animation: fadeIn 0.3s ease-in;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }

            to {
                opacity: 1;
            }
        }
    </style>
</head>

<body class="bg-gradient-to-br from-blue-50 via-white to-orange-50 min-h-screen flex items-center justify-center p-4">

   <div class="max-w-md w-full bg-white rounded-[3rem] shadow-2xl overflow-hidden border border-white mx-auto">
    
    <div class="bg-orange-400 p-12 text-center text-white flex flex-col items-center justify-center gap-6">
        <div class="bg-white p-2 rounded-full shadow-lg">
            <img src="assets/img/logo.png" alt="Logo Educa Materiais" class="w-28 h-28 object-contain">
        </div>

        <div class="space-y-2">
            <h1 class="text-5xl font-black text-white italic tracking-tighter leading-none">
                Educa Materiais
            </h1>
            <p class="text-sm opacity-95 uppercase tracking-[0.3em] font-bold">
                Portal do Educador
            </p>
        </div>
    </div>

    <div class="flex border-b border-gray-100">
        <button onclick="switchTab('login')" id="tab-login"
            class="flex-1 py-5 font-bold text-gray-400 tab-active transition-all text-lg">
            Entrar
        </button>
        <button onclick="switchTab('cadastro')" id="tab-cadastro"
            class="flex-1 py-5 font-bold text-gray-400 transition-all text-lg">
            Cadastrar
        </button>
    </div>

    <div class="p-10">
        <form id="form-auth" class="space-y-5" onsubmit="processarAuth(event)">
            
            <div id="wrapper-nome" class="hidden fade-in">
                <label class="block text-xs font-bold text-gray-500 uppercase mb-1 ml-1">Nome Completo</label>
                <input type="text" id="nome" placeholder="Ex: Prof. Cl√°udia Silva"
                    class="w-full px-5 py-4 rounded-2xl border-2 border-gray-100 focus:border-orange-400 outline-none transition-all">
            </div>

            <div>
                <label class="block text-xs font-bold text-gray-500 uppercase mb-1 ml-1">E-mail</label>
                <input type="email" id="email" required placeholder="seu@email.com"
                    class="w-full px-5 py-4 rounded-2xl border-2 border-gray-100 focus:border-orange-400 outline-none transition-all">
            </div>

            <div>
                <label class="block text-xs font-bold text-gray-500 uppercase mb-1 ml-1">Senha</label>
                <input type="password" id="senha" required placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"
                    class="w-full px-5 py-4 rounded-2xl border-2 border-gray-100 focus:border-orange-400 outline-none transition-all">
            </div>

            <div id="wrapper-whats" class="hidden fade-in">
                <label class="block text-xs font-bold text-gray-500 uppercase mb-1 ml-1">WhatsApp</label>
                <input type="tel" id="whatsapp" placeholder="(00) 00000-0000"
                    class="w-full px-5 py-4 rounded-2xl border-2 border-gray-100 focus:border-orange-400 outline-none transition-all">
            </div>

            <button type="submit" id="btn-submit"
                class="w-full bg-blue-500 hover:bg-blue-600 text-white font-black py-5 rounded-2xl shadow-xl shadow-blue-200 mt-4 uppercase text-lg transition-all active:scale-95">
                Entrar Agora
            </button>
        </form>

        <p class="text-center text-gray-400 text-[10px] mt-8 font-medium">
            Protegido por criptografia Educa Materiais
        </p>
    </div>
</div>

    <script>
        let abaAtual = 'login';
        // Defina aqui seu email de admin
        const MEU_EMAIL_ADMIN = "elitonnrenato@gmail.com";

        function switchTab(tipo) {
            abaAtual = tipo;
            const isLogin = tipo === 'login';

            document.getElementById('tab-login').classList.toggle('tab-active', isLogin);
            document.getElementById('tab-cadastro').classList.toggle('tab-active', !isLogin);

            document.getElementById('wrapper-nome').classList.toggle('hidden', isLogin);
            document.getElementById('wrapper-whats').classList.toggle('hidden', isLogin);

            document.getElementById('nome').required = !isLogin;
            document.getElementById('whatsapp').required = !isLogin;

            document.getElementById('btn-submit').innerText = isLogin ? 'Entrar Agora' : 'Criar Minha Conta';
        }

        async function processarAuth(e) {
            e.preventDefault();
            const btn = document.getElementById('btn-submit');

            const emailDigitado = document.getElementById('email').value.trim();
            const payload = {
                nome: document.getElementById('nome').value,
                email: emailDigitado,
                senha: document.getElementById('senha').value,
                whatsapp: document.getElementById('whatsapp').value
            };

            const url = `http://localhost:3000/${abaAtual}`;

            try {
                btn.innerText = 'Processando... üçé';
                btn.disabled = true;

                const response = await fetch(url, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                const data = await response.json();

                if (data.sucesso) {
                    if (abaAtual === 'cadastro') {
                        alert('‚úÖ Conta criada com sucesso! Fa√ßa seu login.');
                        window.location.reload(); // Recarrega para limpar a tela e voltar ao login
                        return;
                    }

                    // Se for LOGIN bem-sucedido:
                    localStorage.clear();
                    localStorage.setItem('prof_nome', data.nome || 'Professor(a)');
                    localStorage.setItem('prof_email', data.email || emailDigitado);

                    // L√≥gica de Admin
                    const isAdmin = (data.email || emailDigitado).toLowerCase() === MEU_EMAIL_ADMIN.toLowerCase();
                    localStorage.setItem('prof_admin', isAdmin ? 'true' : 'false');

                    window.location.href = 'index.html';
                } else {
                    alert('‚ö†Ô∏è ' + (data.erro || 'Erro ao processar.'));
                }
            } catch (error) {
                console.error('Erro:', error);
                alert('‚ùå Erro de conex√£o com o servidor.');
            } finally {
                btn.disabled = false;
                btn.innerText = abaAtual === 'login' ? 'Entrar Agora' : 'Criar Minha Conta';
            }
        }
    </script>
</body>

</html>